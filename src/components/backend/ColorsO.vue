<template>
  <section class="products">

    <transition name="fall" mode="out-in">

      <loading v-if="loadingState" key="1" pic="loading" />

      <div v-else :key="2" class="list__container">

        <button @click="add()">
          <svg width="30px" x="0px" y="0px"
              viewBox="0 0 511.998 511.998" style="enable-background:new 0 0 511.998 511.998;" xml:space="preserve">
            <polygon style="fill:#51cbe9;" points="190.338,190.338 16.625,190.34 16.625,321.664 190.338,321.664 190.336,495.377 
              321.662,495.377 321.662,322.201 321.662,321.664 "/>
            <path style="fill:#235966;" d="M495.375,173.713H338.288V16.626c0-9.182-7.445-16.625-16.625-16.625H190.336
              c-9.18,0-16.625,7.443-16.625,16.625v157.087H16.625C7.445,173.713,0,181.156,0,190.338l0,0v131.324l0,0
              c0,0.557,0.028,1.111,0.085,1.659c0.04,0.399,0.108,0.79,0.176,1.18c0.025,0.143,0.037,0.289,0.066,0.432
              c0.093,0.465,0.214,0.921,0.344,1.372c0.02,0.066,0.032,0.135,0.052,0.201c0.138,0.456,0.303,0.899,0.479,1.338
              c0.025,0.063,0.043,0.128,0.07,0.191c0.171,0.409,0.366,0.806,0.567,1.199c0.047,0.091,0.085,0.185,0.133,0.274
              c0.186,0.347,0.396,0.682,0.607,1.012c0.08,0.128,0.151,0.261,0.234,0.387c0.191,0.286,0.404,0.554,0.612,0.826
              c0.121,0.16,0.233,0.328,0.361,0.482c0.206,0.251,0.434,0.484,0.653,0.723c0.145,0.156,0.278,0.323,0.431,0.474
              c0.153,0.153,0.321,0.288,0.479,0.434c0.238,0.219,0.469,0.444,0.718,0.65c0.158,0.13,0.328,0.243,0.49,0.366
              c0.269,0.206,0.537,0.417,0.82,0.607c0.131,0.088,0.269,0.161,0.402,0.244c0.328,0.206,0.655,0.412,0.996,0.597
              c0.101,0.055,0.208,0.096,0.309,0.15c0.381,0.195,0.765,0.384,1.162,0.549c0.083,0.035,0.171,0.06,0.254,0.093
              c0.417,0.166,0.838,0.324,1.272,0.456c0.103,0.032,0.211,0.052,0.314,0.081c0.414,0.118,0.831,0.231,1.257,0.316
              c0.213,0.043,0.432,0.065,0.647,0.098c0.321,0.052,0.638,0.111,0.966,0.145c0.552,0.055,1.109,0.085,1.667,0.085H173.71v157.089
              c0,9.182,7.445,16.625,16.625,16.625H321.66c9.18,0,16.625-7.443,16.625-16.625V321.664c0-0.557-0.028-1.111-0.083-1.659
              c-0.04-0.404-0.11-0.8-0.178-1.195c-0.025-0.138-0.037-0.279-0.063-0.417c-0.095-0.477-0.218-0.944-0.354-1.406
              c-0.017-0.055-0.027-0.111-0.042-0.165c-0.143-0.469-0.313-0.928-0.494-1.378c-0.02-0.05-0.035-0.101-0.055-0.15
              c-0.176-0.426-0.377-0.838-0.589-1.244c-0.038-0.075-0.07-0.155-0.11-0.229c-0.196-0.364-0.414-0.713-0.635-1.061
              c-0.071-0.111-0.133-0.229-0.206-0.339c-0.209-0.313-0.441-0.608-0.67-0.904c-0.103-0.133-0.195-0.273-0.303-0.404
              c-0.269-0.328-0.56-0.637-0.853-0.943c-0.081-0.085-0.151-0.176-0.234-0.259L206.961,183.454V33.251h98.076v157.087
              c0,9.182,7.445,16.625,16.625,16.625h157.087v98.076h-64.815c-9.18,0-16.625,7.443-16.625,16.625s7.445,16.625,16.625,16.625h81.44
              c9.18,0,16.625-7.443,16.625-16.625V190.338C512,181.156,504.555,173.713,495.375,173.713z M305.037,478.752h-98.076V321.664
              c0-0.557-0.028-1.111-0.083-1.659c-0.04-0.404-0.11-0.8-0.178-1.195c-0.025-0.138-0.037-0.279-0.063-0.417
              c-0.095-0.477-0.218-0.944-0.354-1.406c-0.017-0.055-0.027-0.111-0.043-0.165c-0.143-0.469-0.311-0.928-0.494-1.378
              c-0.02-0.05-0.035-0.101-0.055-0.15c-0.176-0.426-0.377-0.838-0.589-1.244c-0.038-0.075-0.07-0.155-0.11-0.229
              c-0.196-0.364-0.414-0.713-0.635-1.061c-0.071-0.111-0.133-0.229-0.206-0.339c-0.209-0.313-0.441-0.608-0.67-0.904
              c-0.103-0.133-0.195-0.273-0.303-0.404c-0.269-0.328-0.56-0.637-0.853-0.943c-0.081-0.085-0.151-0.176-0.234-0.259
              c-0.078-0.078-0.166-0.146-0.246-0.223c-0.311-0.298-0.623-0.592-0.956-0.865c-0.123-0.101-0.258-0.19-0.384-0.286
              c-0.304-0.236-0.607-0.472-0.926-0.685c-0.103-0.07-0.213-0.126-0.318-0.193c-0.354-0.226-0.712-0.449-1.082-0.647
              c-0.07-0.037-0.143-0.066-0.213-0.103c-0.411-0.213-0.828-0.416-1.258-0.595c-0.047-0.02-0.096-0.033-0.143-0.053
              c-0.452-0.183-0.913-0.352-1.385-0.495c-0.057-0.017-0.113-0.027-0.17-0.043c-0.461-0.135-0.926-0.258-1.401-0.352
              c-0.14-0.028-0.283-0.04-0.422-0.065c-0.394-0.068-0.788-0.138-1.19-0.178c-0.549-0.055-1.102-0.083-1.659-0.083H33.249V206.97
              h150.201l121.588,121.587v150.196H305.037z"/>
          </svg>
          Add
        </button>
        
<!--         <form @submit.prevent="save()" v-show="showForm" class="list__modify">
          <label>
            <input type="text" name="name" id="name" placeholder=" "
                  v-model="color.name" >
            <span>Color</span>
          </label>
          <div class="form__buttons">
            <button type="submit">
              <svg width="40px" x="0px" y="0px"
                  viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
                <polygon style="fill:#51cbe9;" points="228.384,265.275 98.306,135.197 56.616,176.887 14.927,218.576 145.005,348.654 "/>
                <path style="fill:#235966;" d="M507.628,152.789L424.249,69.41c-5.829-5.829-15.282-5.829-21.11,0L228.384,244.165L108.861,124.642
                  c-5.828-5.829-15.281-5.829-21.11,0L4.372,208.021c-0.354,0.354-0.687,0.722-1,1.106c-0.242,0.296-0.458,0.603-0.675,0.911
                  c-0.063,0.09-0.134,0.175-0.196,0.266c-0.248,0.372-0.472,0.752-0.682,1.139c-0.021,0.037-0.045,0.072-0.066,0.11
                  c-0.209,0.391-0.393,0.79-0.564,1.194c-0.018,0.042-0.04,0.082-0.058,0.125c-0.158,0.384-0.294,0.775-0.418,1.169
                  c-0.022,0.07-0.052,0.139-0.073,0.21c-0.11,0.364-0.196,0.734-0.278,1.105c-0.024,0.106-0.057,0.21-0.078,0.316
                  c-0.069,0.349-0.113,0.7-0.157,1.052c-0.016,0.133-0.045,0.263-0.057,0.396c-0.043,0.449-0.064,0.902-0.067,1.352
                  c0,0.034-0.004,0.069-0.004,0.103c0,0.034,0.004,0.069,0.004,0.103c0.003,0.451,0.024,0.903,0.067,1.352
                  c0.013,0.133,0.04,0.263,0.057,0.396c0.043,0.352,0.088,0.703,0.157,1.052c0.021,0.106,0.054,0.209,0.076,0.313
                  c0.082,0.372,0.169,0.742,0.279,1.108c0.021,0.067,0.048,0.131,0.07,0.199c0.125,0.397,0.263,0.791,0.422,1.179
                  c0.016,0.04,0.037,0.078,0.055,0.118c0.172,0.408,0.358,0.809,0.569,1.203c0.015,0.028,0.034,0.055,0.049,0.084
                  c0.215,0.397,0.445,0.787,0.699,1.167c0.046,0.069,0.1,0.133,0.148,0.2c0.23,0.331,0.464,0.661,0.724,0.978
                  c0.205,0.251,0.431,0.485,0.652,0.722c0.118,0.125,0.222,0.258,0.345,0.381l213.455,213.458c2.915,2.915,6.735,4.372,10.555,4.372
                  s7.641-1.457,10.555-4.372c5.829-5.829,5.829-15.281,0-21.11l-72.824-72.824l72.824-72.824c0.003-0.003,0.004-0.006,0.007-0.007
                  l174.748-174.749l62.269,62.269L301.208,338.1c-5.829,5.829-5.829,15.281,0,21.11c5.829,5.829,15.281,5.829,21.111,0
                  l185.309-185.312C513.457,168.07,513.457,158.618,507.628,152.789z M98.306,156.307l108.968,108.968l-62.269,62.269L36.037,218.576
                  L98.306,156.307z"/>
              </svg>
              Save
            </button>
            <button type="submit" @click.prevent="cancel()">
              <svg width="30px" x="0px" y="0px"
                  viewBox="0 0 512.003 512.003" style="enable-background:new 0 0 512.003 512.003;" xml:space="preserve">
                <polygon style="fill:#51cbe9;" points="256.001,158.605 114.833,17.437 17.437,114.83 158.605,256 17.437,397.17 114.833,494.563 
                  255.603,353.793 256.001,353.395 "/>
                <path style="fill:#235966;" d="M378.055,256l128.84-128.839c6.809-6.809,6.809-17.85,0-24.659L409.498,5.105
                  c-6.807-6.807-17.85-6.807-24.659,0L256.001,133.944L127.162,5.105c-0.425-0.425-0.868-0.825-1.325-1.196
                  C122.643,1.303,118.737,0,114.833,0c-2.232,0-4.462,0.425-6.561,1.276c-2.099,0.851-4.066,2.127-5.768,3.829L5.108,102.503
                  c-6.809,6.809-6.809,17.85,0,24.659L133.948,256L5.108,384.839c-6.809,6.809-6.809,17.85,0,24.659l97.395,97.395
                  c3.405,3.404,7.867,5.107,12.329,5.107c4.462,0,8.926-1.704,12.329-5.107l140.771-140.772l0.398-0.398
                  c0.413-0.413,0.802-0.844,1.168-1.292c0.277-0.34,0.527-0.694,0.776-1.048c0.077-0.112,0.166-0.214,0.241-0.328
                  c0.289-0.432,0.549-0.877,0.795-1.329c0.024-0.044,0.052-0.085,0.077-0.129c0.244-0.459,0.462-0.926,0.663-1.4
                  c0.021-0.047,0.045-0.092,0.065-0.141c0.185-0.45,0.344-0.907,0.49-1.367c0.026-0.082,0.059-0.16,0.085-0.244
                  c0.127-0.422,0.227-0.849,0.321-1.278c0.028-0.129,0.068-0.253,0.094-0.382c0.08-0.405,0.131-0.814,0.183-1.222
                  c0.019-0.157,0.052-0.31,0.068-0.467c0.051-0.525,0.075-1.053,0.078-1.58c0-0.04,0.005-0.08,0.005-0.12V165.829L397.171,42.095
                  l72.737,72.737l-128.84,128.839c-6.809,6.809-6.809,17.85,0,24.661l128.84,128.839l-72.737,72.737l-60.407-60.407
                  c-6.809-6.809-17.85-6.809-24.661,0c-6.809,6.809-6.809,17.85,0,24.661l72.737,72.737c3.405,3.404,7.867,5.107,12.329,5.107
                  c4.462,0,8.926-1.704,12.329-5.107l97.395-97.395c6.809-6.809,6.809-17.85,0-24.659L378.055,256z M170.937,268.329
                  c6.809-6.809,6.809-17.85,0-24.661L42.096,114.83l72.737-72.737l123.732,123.733v180.345L114.833,469.905l-72.737-72.737
                  L170.937,268.329z"/>
              </svg>
              Cancel
            </button>
          </div>
        </form> -->

        <form-generator v-show="showForm" :schema="schema"
                    :v-model="color">
        </form-generator>

        <ul class="list" >
          
          <li v-for="color in colors" :key="color.id" 
              class="products__list_item">
              <!-- <img :src="getJpgUrl(shoe.image)" alt="" class="products__logo"> -->
            <h3 @click="selectColor(color)">{{ color.name }}</h3>
            <svg @click.prevent="remove(color)" width="30px" x="0px" y="0px"
                viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
              <polygon style="fill:#51cbe9;" points="14.713,197.889 14.713,314.11 198.365,314.11 314.584,197.889 "/>
              <path style="fill:#235966;" d="M497.287,183.176H314.584H14.713C6.587,183.176,0,189.763,0,197.889V314.11
                c0,8.126,6.587,14.713,14.713,14.713h183.652c0.48,0,0.959-0.025,1.436-0.071c0.122-0.012,0.24-0.037,0.36-0.052
                c0.356-0.044,0.712-0.09,1.065-0.159c0.104-0.021,0.205-0.053,0.307-0.075c0.366-0.081,0.731-0.166,1.092-0.275
                c0.072-0.022,0.14-0.052,0.212-0.074c0.385-0.124,0.769-0.255,1.146-0.41c0.046-0.019,0.09-0.044,0.135-0.063
                c0.394-0.168,0.783-0.347,1.164-0.55c0.046-0.024,0.087-0.053,0.132-0.078c0.372-0.205,0.742-0.419,1.099-0.658
                c0.106-0.071,0.203-0.152,0.306-0.225c0.288-0.203,0.578-0.406,0.855-0.633c0.378-0.309,0.743-0.639,1.092-0.986l111.912-111.912
                h161.897v86.796H335.938c-8.124,0-14.713,6.587-14.713,14.713s6.588,14.713,14.713,14.713h161.349
                c8.124,0,14.713-6.587,14.713-14.713V197.89C512,189.763,505.412,183.176,497.287,183.176z M29.425,212.601h249.64l-86.796,86.796
                H29.425V212.601z"/>
            </svg>
          </li>
        </ul>

      </div>
    </transition>
  </section>
</template>

<script>
  import { mapGetters, mapActions } from 'vuex';
  import Loading from '@/components/utils/Loading.vue';
  import FormGenerator from '@/components/backend/partials/FormGenerator.vue';
  import loadingM from '../../mixins/loading';
  import imageUrl from '../../mixins/imageUrl';

  export default {
    name: 'Colors',

    props: {
      msg: String
    },

    components: {
      Loading,
      FormGenerator
    },

    mixins: [
      loadingM,
      imageUrl
    ],

    data() {
      return {
        colors: [],
        color: {
          name: ''
        },
        showForm: false,
        dataType: 'getAll' + this.msg + 's',
        currentPage: 0,
        lastPage: 0,
        nextPage: null,
        schema: [
          {
            fieldType: "TextInput",
            name: "color"
          }
        ]
      }
    },

    computed: {
      ...mapGetters([ 'getAllColors', 
                      'getOneColor' ]),
    },

    methods: {
      ...mapActions([ 'fetchColors', 
                      'fetchColor',
                      'colorAdd',
                      'colorDelete',
                      'colorUpdate',
                      'colorClear',
                      'setActiveComponent' ]),

      async selectColor(item) {
        await this.fetchColor(item);
        this.color = this.getOneColor.data;
        this.showForm = true;
      },

      async save(item = this.color) {
        if (this.getOneColor.data) {
          await this.colorUpdate(item);
        } else {
          console.log(item)
          await this.colorAdd(item);
        }
        this.colors = this.getAllColors;
        this.cancel();
      },

      cancel() {
        this.colorClear();
        this.color = {};
        this.showForm = false;
      },

      add() {
        this.showForm = true;
      },

      async remove(item) {
        await this.colorDelete(item);
        //await this.colorClear();
        this.colors = this.getAllColors;
      },

      setPage() {
        this.currentPage = this.getAllShoes.current_page;
        this.lastPage = this.getAllShoes.last_page;
        this.nextPage = this.getAllShoes.next_page_url;
      }
    },

    async mounted() {
      await this.fetchColors();
      this.colors = this.getAllColors;
      //this.setPage();
      this.setLoadingState(false);
    },

    created() {
      this.setLoadingState(true);
    }
  }
</script>

<style lang="scss" scoped>
  .list__container {
    .list {
      li {
        display: flex;
        justify-content: space-between;
        align-items: center;
        column-gap: 1em;
        padding: 1em;
        margin-top: 1em;
        border-top: 1px solid $primary-turquoise;

    
          cursor: pointer;

          input:disabled {
            background-color: transparent;
            color: $primary-turquoise-dark;
          }
        

        svg {
          cursor: pointer;
        }
      }

      li:nth-child(even) {
        color: $primary-turquoise;
      }

      li:hover {
        color: $secondary-cyclamen;
      }
    }

  }
</style>